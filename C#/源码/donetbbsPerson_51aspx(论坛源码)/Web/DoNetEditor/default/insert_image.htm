<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>上传图片</title>

<STYLE >
body {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"; 
}
BUTTON {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"; 
}
DIV {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"; 
}
INPUT {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体";
}
SELECT {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体";
}
IFRAME {
	FONT-SIZE: 9pt; FONT-FAMILY: "宋体"; 
}
</STYLE>
</head>

<body style="BACKGROUND: buttonface; COLOR: windowtext" scroll=no onresize="windowclose()">

<table width="400" height="200" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td valign="top" bgcolor="#D4D0C8"><table width="400" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td width="83" height="30" align="center">图片地址</td>
        <td width="317" height="30" colspan="2">
		<div style="float:left" id="InputDiv">
		<input type="text" name="selFile" style="width:220px;" /> 
		</div>
		<div style="float:left;display:none; width:226px; height:24px;" id="UploadDiv">
		<IFRAME 
style=" WIDTH: 100%; HEIGHT: 100%" 
src="../../UserUploadFile.aspx" frameBorder=0 scrolling=no id="InsertFileIframe" name="InsertFileIframe"></IFRAME>
		</div>
		<input type="checkbox" name="selCheckBox" value="checkbox" onclick="JsCheckBox()"/>
          本地图片</td>
      </tr>
      <tr>
        <td height="30" align="center">图片说明</td>
        <td height="30" colspan="2"><input type="text" name="selTitle" style="width:220px;" /></td>
      </tr>
      <tr>
        <td height="108" colspan="3" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td align="center"><FIELDSET id=fldLayout 
	style="LEFT: 10px; WIDTH: 170px; TOP: 10px; HEIGHT: 110px"><LEGEND 
id=lgdLayout>溢出</LEGEND>
                <table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td width="35%" height="40">对齐方式</td>
    <td width="65%" align="left"><SELECT 
id=selAlignment 
style="LEFT: 10.36em; WIDTH: 6.72em; TOP: 8.82em; HEIGHT: 1.21em" > 
<OPTION value="" selected="selected">默认</OPTION> <OPTION  
  value=left>左</OPTION> <OPTION  value=right>右</OPTION> <OPTION 
   value=textTop>文本顶端</OPTION> <OPTION  
  value=absMiddle>居中</OPTION> <OPTION  value=baseline>底边</OPTION> <OPTION  value=absBottom>绝对底部</OPTION> 
  <OPTION value=bottom>底部</OPTION> <OPTION  
  value=middle>中间</OPTION> <OPTION value=top>顶端</OPTION>
    </SELECT> 
  </td>
  </tr>
  <tr>
    <td height="40">边框大小</td>
    <td align="left"><select name="selBoard" 
id="select" 
style="LEFT: 10.36em; WIDTH: 6.72em; TOP: 8.82em; HEIGHT: 1.21em" >
      <option value="0" selected="selected">默认</option>
      <option  
  value="1">1 px</option>
      <option  
  value="1">2 px</option>
  <option  
  value="1">3 px</option>
  <option  
  value="1">4 px</option>
  <option  
  value="1">5 px</option>
    </select></td>
  </tr>
</table>

            </FIELDSET> </td>
            <td align="center"><FIELDSET id=fldLayouts 
style="LEFT: 10px; WIDTH: 170px; TOP: 10px; HEIGHT: 110px"><LEGEND 
id=LEGEND1>大小</LEGEND>
                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td width="35%" height="40">图片高度</td>
                    <td width="65%" align="left"><input type="text" name="selWidth" style="width:40px;" /> px</td>
                  </tr>
                  <tr>
                    <td height="40">图片宽度</td>
                    <td align="left"><input type="text" name="selHeight" style="width:40px;" /> px</td>
                  </tr>
                </table>
            </FIELDSET> </td>
          </tr>
        </table></td>
        </tr>
      
      <tr>
        <td height="30" colspan="3" align="center">
		
		<BUTTON 
style="LEFT: 31.36em; WIDTH: 7em; TOP: 1.06em; HEIGHT: 2.2em" id="btnOK"
type=button onclick="Upload('InsertFileIframe');">确 定</BUTTON>&nbsp;<BUTTON 
style="LEFT: 31.36em; WIDTH: 7em; TOP: 1.06em; HEIGHT: 2.2em" tabIndex=40 
type=button onclick="windowclose();">取 消</BUTTON>

</td>
        </tr>
    </table></td>
  </tr>
</table>

<IFRAME id="IframeTarGet" name="IframeTarGet" marginWidth="0" marginHeight="0" src="about:blank" frameBorder="0" width="0" scrolling="no" height="0"></IFRAME>
</body>
</html>
<script>
function JsCheckBox()
{
	if (document.all.UploadDiv.style.display=='none')
	{
		document.all.UploadDiv.style.display='';
		document.all.InputDiv.style.display='none';
		document.all.selCheckBox.checked=true;
	}
	else
	{
		document.all.InputDiv.style.display='';
		document.all.UploadDiv.style.display='none';
		document.all.selCheckBox.checked=null;
	}
}//
function Upload(n1)
{
	var globalDoc = (window.dialogArguments).window;
	globalDoc.ScreenConvert();
	document.all.btnOK.disabled=true;
	if (!document.all.selCheckBox.checked)
	{
	    if (document.all.selFile.value=='')
	        {
	            alert("请先填入输入地址");
	document.all.btnOK.disabled=false;
	            globalDoc.ScreenClear();
	            
                return;
	        }
	        JsSettingImages(document.all.selFile.value);
	}
	else
	{
	var framsForm=document.frames[n1].document.forms[0];
	    if (framsForm.UploadFile.value=='')
	        {
	            alert("请先填入输入地址");
	            globalDoc.ScreenClear();
	            	document.all.btnOK.disabled=false;
                return;
	        }
	        //var action=framsForm.action;
            framsForm.target='IframeTarGet';
            //framsForm.action+="?n2="+n2+"&n3="+n3+"&n4="+n4+"&n5="+n5+"&n6="+n6+"&n7="+n7+"&n8="+n8
            framsForm.submit();
            //framsForm.action=action;
	}
    //document.frames[n1].document.forms[0].target='InsertFileIframe';
   // document.frames[n1].document.forms[0].submit();
}
function DosJavaScriptUpLoadFileOk(n1,n2,n3,n4,n5,n6,n7)
{
var globalDoc = (window.dialogArguments).window;
globalDoc.ScreenClear();

    JsSettingImages(''+n1+'');
}
function JsSettingImages(n1)
{
var globalDoc = (window.dialogArguments).window;
  //var grngMaster = globalDoc.selection.createRange();
  //grngMaster.execCommand('Delete');
      //grngMaster = globalDoc.selection.createRange();
  //alert(globalDoc.selection.type)

    //elmImage.removeAttribute("src");
    var html="<a href=\""+n1+"\" target=\"_blank\" title=\""+document.all.selTitle.value+"\"><img src=\""+n1+"\" ";
    if (document.all.selBoard.value!="")
    {
    html +=" border=\""+document.all.selBoard.value+"\" ";
    }
    if (document.all.selHeight.value!="")
    {
    html +=" height=\""+document.all.selHeight.value+"\" ";
    }
    if (document.all.selWidth.value!="")
    {
    html +=" width=\""+document.all.selWidth.value+"\" ";
    }
    
    html +=" /></a>";
globalDoc.editor_insertHTML("PostBodyHtml",html,null,null);
windowclose();
}//
function windowclose()
{
var globalDoc = (window.dialogArguments).window;
globalDoc.ScreenClear();
window.close();
}//
</script>